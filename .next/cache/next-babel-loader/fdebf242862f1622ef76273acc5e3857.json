{"ast":null,"code":"import React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport dynamic from 'next/dynamic';\nimport { useState } from 'react';\nimport { connect } from \"react-redux\";\nimport classNames from \"classnames\";\nconst Layout = dynamic(() => import(\"../../components/Layouts/Layout\"), {\n  ssr: false,\n  loadableGenerated: {\n    webpack: () => [require.resolveWeak(\"../../components/Layouts/Layout\")],\n    modules: [\"../../components/Layouts/Layout\"]\n  }\n});\nconst Heading = dynamic(() => import(\"../../components/Heading\"), {\n  ssr: false,\n  loadableGenerated: {\n    webpack: () => [require.resolveWeak(\"../../components/Heading\")],\n    modules: [\"../../components/Heading\"]\n  }\n});\nimport apiList from \"../../services/apis/apiList\";\nconst ProductCard = dynamic(() => import(\"../../components/ProductCard\"), {\n  ssr: false,\n  loadableGenerated: {\n    webpack: () => [require.resolveWeak(\"../../components/ProductCard\")],\n    modules: [\"../../components/ProductCard\"]\n  }\n});\nimport { getProductTitle, getProductShortDesc, getBasicPrice, addSlugToProduct, getVisibleProducts } from \"../../services/helpers/product\";\nimport projectSettings from \"../../constants/projectSettings\";\nconst SearchBox = dynamic(() => import(\"../../components/form-components/SearchBox\"), {\n  ssr: false,\n  loadableGenerated: {\n    webpack: () => [require.resolveWeak(\"../../components/form-components/SearchBox\")],\n    modules: [\"../../components/form-components/SearchBox\"]\n  }\n});\nimport fetch from \"isomorphic-unfetch\";\nimport { shopData } from \"../../redux/actions\";\nimport parse from \"html-react-parser\";\n\nconst Search = (_ref) => {\n  let {\n    productList,\n    combos,\n    shopdata,\n    Search\n  } = _ref,\n      props = _objectWithoutProperties(_ref, [\"productList\", \"combos\", \"shopdata\", \"Search\"]);\n\n  console.log(Search);\n  const {\n    0: searchValue,\n    1: setSearchValue\n  } = useState(Search);\n  const {\n    0: isFilter,\n    1: setIsFilter\n  } = useState(false);\n  const {\n    0: selectedFilters,\n    1: setSelectedFilters\n  } = useState(\"\");\n  const productsRow = productList.map(el => {\n    console.log({\n      price: getBasicPrice(el),\n      el\n    });\n    return _objectSpread(_objectSpread({}, el), {}, {\n      image: el.productImage ? projectSettings.serverUrl + el.productImage : \"//via.placeholder.com/300x500\",\n      title: getProductTitle(el),\n      subTitle: getProductShortDesc(el),\n      price: getBasicPrice(el)\n    });\n  });\n\n  const applySearch = products => products.filter(el => {\n    if (searchValue === \"\") return true;\n    return el.title.toLowerCase().includes(searchValue.toLowerCase());\n  });\n\n  const {\n    0: products,\n    1: setProducts\n  } = useState([...productsRow]);\n\n  const onSearchChange = e => {\n    const {\n      value\n    } = e.target;\n    setSearchValue(value);\n  };\n\n  const filterProducts = key => {\n    setSelectedFilters(key);\n\n    switch (key) {\n      case \"featured\":\n        const featuredProducts = products.filter(product => product.featured);\n        const restProducts = products.filter(product => !product.featured);\n        setProducts([...featuredProducts, ...restProducts]);\n        break;\n\n      case \"l2h\":\n        setProducts(products.sort((a, b) => parseFloat(a.price.sale_price) - parseFloat(b.price.sale_price)));\n        break;\n\n      case \"h2l\":\n        setProducts(products.sort((a, b) => parseFloat(b.price.sale_price) - parseFloat(a.price.sale_price)));\n        break;\n\n      default:\n        // setProducts(products)\n        break;\n    }\n  };\n\n  return __jsx(Layout, {\n    headerVersions: [\"bg-dark\"],\n    headerTheme: \"black\"\n  }, __jsx(\"div\", {\n    className: \"c-search-page\"\n  }, __jsx(\"div\", {\n    className: \"container-fluid\"\n  }, __jsx(\"div\", {\n    className: \"c-search-page__row c-search-page__row--light-bg row justify-content-center\"\n  }, __jsx(\"div\", {\n    className: \"col-md-6\"\n  }, __jsx(Heading, {\n    versions: [\"lft-br\"],\n    parentClass: \"c-search-page\"\n  }, __jsx(SearchBox, {\n    onChange: onSearchChange,\n    value: searchValue,\n    parentClass: \"c-search-page\"\n  })), __jsx(Heading, {\n    subHeading: true,\n    parentClass: \"c-search-page\",\n    versions: [\"default\", \"lft-br\"]\n  }, parse(`${applySearch(products).length} PRODUCT RESULT FOR <span class=\"search-text\">\"${searchValue}\"</span>`))))), __jsx(\"div\", {\n    className: \"c-shop-page__products-wrapper\"\n  }, __jsx(\"div\", {\n    className: \"c-shop-page__row row\"\n  }, applySearch(products).map(el => __jsx(\"div\", {\n    key: el._id,\n    className: \"col-lg-4 col-md-6\"\n  }, __jsx(ProductCard, {\n    product: el,\n    versions: [\"show-price\", \"full-height\"],\n    title: el.title,\n    subTitle: el.subTitle,\n    image: el.image,\n    price: el.price && el.price.sale_price,\n    mg: el.totalcbdmg\n  })))))));\n};\n\nconst FilterItem = ({\n  isActive,\n  onClick,\n  children\n}) => __jsx(\"div\", {\n  className: classNames(\"c-shop-page__filter-item\", {\n    \"c-shop-page__filter-item--active\": isActive\n  }),\n  onClick: onClick\n}, children);\n\nSearch.getInitialProps = async ({\n  query\n}) => {\n  console.log(query.key);\n  const res = await fetch(apiList.getAllProducts);\n  const productList = await res.json();\n  const visibleProducts = getVisibleProducts(productList.products);\n  const Searchdata = await shopData();\n  const comboRes = await fetch(apiList.getAllCombos);\n  const comboList = await comboRes.json();\n  const visibleCombo = getVisibleProducts(comboList.combos);\n  return {\n    Search: query.key,\n    productList: visibleProducts.map(el => addSlugToProduct(el)),\n    combos: visibleCombo.map(el => addSlugToProduct(el)),\n    shopdata: Searchdata.shop\n  };\n};\n\nexport default connect(null)(Search);","map":null,"metadata":{},"sourceType":"module"}