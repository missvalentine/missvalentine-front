{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport dynamic from 'next/dynamic';\nimport { useState } from 'react';\nimport { connect } from \"react-redux\";\nimport classNames from \"classnames\";\nvar Layout = dynamic(function () {\n  return import(\"../../components/Layouts/Layout\");\n}, {\n  ssr: false,\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak(\"../../components/Layouts/Layout\")];\n    },\n    modules: [\"../../components/Layouts/Layout\"]\n  }\n});\nvar Heading = dynamic(function () {\n  return import(\"../../components/Heading\");\n}, {\n  ssr: false,\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak(\"../../components/Heading\")];\n    },\n    modules: [\"../../components/Heading\"]\n  }\n});\nimport apiList from \"../../services/apis/apiList\";\nvar ProductCard = dynamic(function () {\n  return import(\"../../components/ProductCard\");\n}, {\n  ssr: false,\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak(\"../../components/ProductCard\")];\n    },\n    modules: [\"../../components/ProductCard\"]\n  }\n});\nimport { getProductTitle, getProductShortDesc, getBasicPrice, addSlugToProduct, getVisibleProducts } from \"../../services/helpers/product\";\nimport projectSettings from \"../../constants/projectSettings\";\nvar SearchBox = dynamic(function () {\n  return import(\"../../components/form-components/SearchBox\");\n}, {\n  ssr: false,\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak(\"../../components/form-components/SearchBox\")];\n    },\n    modules: [\"../../components/form-components/SearchBox\"]\n  }\n});\nimport fetch from \"isomorphic-unfetch\";\nimport { shopData } from \"../../redux/actions\";\nimport parse from \"html-react-parser\";\n\nvar Search = function Search(_ref) {\n  var productList = _ref.productList,\n      combos = _ref.combos,\n      shopdata = _ref.shopdata,\n      Search = _ref.Search,\n      props = _objectWithoutProperties(_ref, [\"productList\", \"combos\", \"shopdata\", \"Search\"]);\n\n  console.log(Search);\n\n  var _useState = useState(Search),\n      searchValue = _useState[0],\n      setSearchValue = _useState[1];\n\n  var _useState2 = useState(false),\n      isFilter = _useState2[0],\n      setIsFilter = _useState2[1];\n\n  var _useState3 = useState(\"\"),\n      selectedFilters = _useState3[0],\n      setSelectedFilters = _useState3[1];\n\n  var productsRow = productList.map(function (el) {\n    console.log({\n      price: getBasicPrice(el),\n      el: el\n    });\n    return _objectSpread(_objectSpread({}, el), {}, {\n      image: el.productImage ? projectSettings.serverUrl + el.productImage : \"//via.placeholder.com/300x500\",\n      title: getProductTitle(el),\n      subTitle: getProductShortDesc(el),\n      price: getBasicPrice(el)\n    });\n  });\n\n  var applySearch = function applySearch(products) {\n    return products.filter(function (el) {\n      if (searchValue === \"\") return true;\n      return el.title.toLowerCase().includes(searchValue.toLowerCase());\n    });\n  };\n\n  var _useState4 = useState(_toConsumableArray(productsRow)),\n      products = _useState4[0],\n      setProducts = _useState4[1];\n\n  var onSearchChange = function onSearchChange(e) {\n    var value = e.target.value;\n    setSearchValue(value);\n  };\n\n  var filterProducts = function filterProducts(key) {\n    setSelectedFilters(key);\n\n    switch (key) {\n      case \"featured\":\n        var featuredProducts = products.filter(function (product) {\n          return product.featured;\n        });\n        var restProducts = products.filter(function (product) {\n          return !product.featured;\n        });\n        setProducts([].concat(_toConsumableArray(featuredProducts), _toConsumableArray(restProducts)));\n        break;\n\n      case \"l2h\":\n        setProducts(products.sort(function (a, b) {\n          return parseFloat(a.price.sale_price) - parseFloat(b.price.sale_price);\n        }));\n        break;\n\n      case \"h2l\":\n        setProducts(products.sort(function (a, b) {\n          return parseFloat(b.price.sale_price) - parseFloat(a.price.sale_price);\n        }));\n        break;\n\n      default:\n        // setProducts(products)\n        break;\n    }\n  };\n\n  return __jsx(Layout, {\n    headerVersions: [\"bg-dark\"],\n    headerTheme: \"black\"\n  }, __jsx(\"div\", {\n    className: \"c-search-page\"\n  }, __jsx(\"div\", {\n    className: \"container-fluid\"\n  }, __jsx(\"div\", {\n    className: \"c-search-page__row c-search-page__row--light-bg row justify-content-center\"\n  }, __jsx(\"div\", {\n    className: \"col-md-6\"\n  }, __jsx(Heading, {\n    versions: [\"lft-br\"],\n    parentClass: \"c-search-page\"\n  }, __jsx(SearchBox, {\n    onChange: onSearchChange,\n    value: searchValue,\n    parentClass: \"c-search-page\"\n  })), __jsx(Heading, {\n    subHeading: true,\n    parentClass: \"c-search-page\",\n    versions: [\"default\", \"lft-br\"]\n  }, parse(\"\".concat(applySearch(products).length, \" PRODUCT RESULT FOR <span class=\\\"search-text\\\">\\\"\").concat(searchValue, \"\\\"</span>\")))))), __jsx(\"div\", {\n    className: \"c-shop-page__products-wrapper\"\n  }, __jsx(\"div\", {\n    className: \"c-shop-page__row row\"\n  }, applySearch(products).map(function (el) {\n    return __jsx(\"div\", {\n      key: el._id,\n      className: \"col-lg-4 col-md-6\"\n    }, __jsx(ProductCard, {\n      product: el,\n      versions: [\"show-price\", \"full-height\"],\n      title: el.title,\n      subTitle: el.subTitle,\n      image: el.image,\n      price: el.price && el.price.sale_price,\n      mg: el.totalcbdmg\n    }));\n  })))));\n};\n\nvar FilterItem = function FilterItem(_ref2) {\n  var isActive = _ref2.isActive,\n      onClick = _ref2.onClick,\n      children = _ref2.children;\n  return __jsx(\"div\", {\n    className: classNames(\"c-shop-page__filter-item\", {\n      \"c-shop-page__filter-item--active\": isActive\n    }),\n    onClick: onClick\n  }, children);\n};\n\nSearch.getInitialProps = /*#__PURE__*/function () {\n  var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref3) {\n    var query, res, productList, visibleProducts, Searchdata, comboRes, comboList, visibleCombo;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            query = _ref3.query;\n            console.log(query.key);\n            _context.next = 4;\n            return fetch(apiList.getAllProducts);\n\n          case 4:\n            res = _context.sent;\n            _context.next = 7;\n            return res.json();\n\n          case 7:\n            productList = _context.sent;\n            visibleProducts = getVisibleProducts(productList.products);\n            _context.next = 11;\n            return shopData();\n\n          case 11:\n            Searchdata = _context.sent;\n            _context.next = 14;\n            return fetch(apiList.getAllCombos);\n\n          case 14:\n            comboRes = _context.sent;\n            _context.next = 17;\n            return comboRes.json();\n\n          case 17:\n            comboList = _context.sent;\n            visibleCombo = getVisibleProducts(comboList.combos);\n            return _context.abrupt(\"return\", {\n              Search: query.key,\n              productList: visibleProducts.map(function (el) {\n                return addSlugToProduct(el);\n              }),\n              combos: visibleCombo.map(function (el) {\n                return addSlugToProduct(el);\n              }),\n              shopdata: Searchdata.shop\n            });\n\n          case 20:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function (_x) {\n    return _ref4.apply(this, arguments);\n  };\n}();\n\nexport default connect(null)(Search);","map":null,"metadata":{},"sourceType":"module"}