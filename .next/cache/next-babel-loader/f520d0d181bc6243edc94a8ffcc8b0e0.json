{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { encodeUrlFn, getParentage, numberFormat } from \"./misc\";\nimport { variablePriceSet } from \"./cart\";\nexport var getProductImage = function getProductImage() {\n  var product = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var image = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"main\";\n\n  if (image === \"main\") {\n    if (product.productid) {\n      if (product.productid.featurefilepath) return product.productid.featurefilepath;\n    }\n\n    if (product.productId) {\n      if (product.productId.featurefilepath) return product.productId.featurefilepath;\n    }\n\n    if (product.featureimage) return product.featureimage;\n    if (product.galleryimgdetails) return product.galleryimgdetails[0];\n  }\n\n  if (image === \"sectionB\") {\n    if (product.productid) {\n      if (product.productid.sectionbimage) return product.productid.sectionbimage;\n    }\n\n    if (product.productId) {\n      if (product.productId.sectionbimage) return product.productId.sectionbimage;\n    }\n\n    if (product.sectionbimage) return product.sectionbimage;\n  }\n\n  return null;\n};\nexport var getProductImageArray = function getProductImageArray() {\n  var product = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var image = [];\n\n  if (product.productid) {\n    if (product.productid.featurefilepath) image = [].concat(_toConsumableArray(image), [product.productid.featurefilepath]);\n  }\n\n  if (product.featureimage) image = [].concat(_toConsumableArray(image), [product.featureimage]);\n  if (product.galleryimgdetails) image = [].concat(_toConsumableArray(image), _toConsumableArray(product.galleryimgdetails));\n  return image;\n};\nexport var getProductAttributes = function getProductAttributes() {\n  var product = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var allProducts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n\n  if (product.combo) {\n    return product.products.map(function (el) {\n      var combo_pid = el.combo_pid;\n      var thisProduct = allProducts.find(function (elx) {\n        return elx._id === combo_pid;\n      });\n\n      if (thisProduct) {\n        return {\n          title: thisProduct.title || thisProduct.productid && thisProduct.productid.producttitle,\n          description: thisProduct.description || thisProduct.productid && thisProduct.productid.description\n        };\n      }\n\n      return null;\n    }).filter(function (el) {\n      return el;\n    });\n  }\n\n  return product.attributecontent || [];\n};\nexport var getProductDescription = function getProductDescription(product) {\n  if (product) {\n    if (product.productid) {\n      return product.productid.description;\n    }\n\n    if (product.description) {\n      return product.description;\n    }\n  }\n\n  return \"\";\n};\nexport var getProductTitle = function getProductTitle(product) {\n  if (product) {\n    if (product.title) {\n      return product.title;\n    }\n\n    if (product.productid) {\n      return product.productid.producttitle;\n    }\n\n    if (product.producttitle) {\n      return product.producttitle;\n    }\n  }\n\n  return \"\";\n};\nexport var getProductShortDesc = function getProductShortDesc(product) {\n  if (product) {\n    if (product.sdescription) {\n      return product.sdescription;\n    }\n\n    if (product.productid) {\n      return product.productid.sdescription;\n    }\n  }\n\n  return \"\";\n}; //\n\nexport var filteredAttr = function filteredAttr(variation, attr) {\n  var attrX = variation.map(function (el) {\n    var sale_price = el.sale_price,\n        sku = el.sku,\n        bar = el.bar,\n        regular_price = el.regular_price,\n        rest = _objectWithoutProperties(el, [\"sale_price\", \"sku\", \"bar\", \"regular_price\"]);\n\n    return _objectSpread({}, rest);\n  });\n  var attrY = attrX.filter(function (el) {\n    return Object.keys(el).length === attr.length;\n  });\n  var attrZ = removeDuplicateObjAr(attrY);\n  return attrZ;\n};\nexport var removeDuplicateObjAr = function removeDuplicateObjAr(arr) {\n  return arr.reduce(function (r, i) {\n    return !r.some(function (j) {\n      return Object.keys(i).length === Object.keys(j).length && !Object.keys(i).some(function (k) {\n        return i[k] !== j[k];\n      });\n    }) ? [].concat(_toConsumableArray(r), [i]) : r;\n  }, []);\n};\nexport var getAttrListing = function getAttrListing() {\n  var attr = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  return attr.length > 0 ? Object.keys(attr[0]).map(function (el) {\n    return {\n      names: el,\n      values: _toConsumableArray(new Set(attr.map(function (elx) {\n        return elx[el];\n      })))\n    };\n  }) : [];\n};\nexport var getFeaturedProduct = function getFeaturedProduct() {\n  var products = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  var filterProduct = getVisibleProducts(products).filter(function (el) {\n    if (!el) return false;\n    if (el.featured !== true) return false;\n    return true;\n  });\n  return filterProduct;\n};\nexport var getVisibleProducts = function getVisibleProducts() {\n  var products = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  var productsList = products.filter(function (el) {\n    if (!el) return false;\n    if (el.visibilitytype !== true) return false;\n    return true;\n  });\n  return productsList.map(function (el) {\n    if (el.combo) return el;\n\n    if (el.variation) {\n      var verifiedAttr = filteredAttr(el.variation, el.attributes);\n      return _objectSpread(_objectSpread({}, el), {}, {\n        verifiedAttr: verifiedAttr,\n        visibleAttrList: getAttrListing(verifiedAttr)\n      });\n    } else return el;\n  });\n};\nexport var generateProductSlug = function generateProductSlug(product) {\n  var productSlug = product.title ? product.title.toLocaleLowerCase() : product.productid && product.productid.producttitle.toLocaleLowerCase();\n  return encodeUrlFn(productSlug);\n};\nexport var addSlugToProduct = function addSlugToProduct(product) {\n  return _objectSpread(_objectSpread({}, product), {}, {\n    productImage: getProductImage(product),\n    productSlug: generateProductSlug(product)\n  });\n};\nexport var getCategoriesProducts = function getCategoriesProducts(products) {\n  var productsN = products.filter(function (el) {\n    return el.categoryid;\n  });\n  var combos = products.filter(function (el) {\n    return el.combo;\n  });\n  var filtered = productsN.map(function (el) {\n    return productsN.filter(function (elx) {\n      if (el.categoryid[0] && elx.categoryid[0]) return el.categoryid[0]._id === elx.categoryid[0]._id;\n      return false;\n    });\n  }).sort(function (a, b) {\n    if (a[0] && b[0]) if (a[0].categoryid[0] && b[0].categoryid[0]) {\n      if (a[0].categoryid[0]._id < b[0].categoryid[0]._id) return -1;\n      if (a[0].categoryid[0]._id > b[0].categoryid[0]._id) return 1;\n    }\n    return 0;\n  });\n  var productsF = filtered.filter(function (el, x) {\n    if (x === 0) return true;\n\n    if (filtered[x - 1] && el[0]) {\n      if (filtered[x - 1][0]) {\n        if (filtered[x - 1][0].categoryid[0] && el[0].categoryid[0]) {\n          var prevEl = filtered[x - 1][0].categoryid[0]._id;\n          var currentEl = el[0].categoryid[0]._id;\n          return prevEl !== currentEl;\n        }\n      }\n    }\n\n    return false; // const prevEl = filtered[x - 1][0].categoryid[0]._id;\n    // const currentEl = el[0].categoryid[0]._id;\n    // return prevEl !== currentEl;\n  });\n  var cate = [].concat(_toConsumableArray(productsF), [combos]);\n  return cate.map(function (el) {\n    if (el.length) {\n      if (el[0].combo) {\n        return {\n          category: {\n            blockedcountries: [],\n            catdescription: \"Bundles\",\n            categoryid: \"Bundles\",\n            categoryslug: \"Bundles\",\n            categorytitle: \"Bundles\",\n            _id: \"Bundles\",\n            products: el\n          },\n          products: el\n        };\n      }\n\n      return {\n        category: _objectSpread(_objectSpread({}, el[0].categoryid[0]), {}, {\n          products: el\n        }),\n        products: el\n      };\n    }\n\n    return null;\n  }).filter(function (el) {\n    return el;\n  });\n};\nexport var getProductPrice = function getProductPrice(product, qty, state) {\n  var sale_price = state.sale_price,\n      regular_price = state.regular_price,\n      subscribeChecked = state.subscribeChecked,\n      subscribeDiscount = state.subscribeDiscount;\n\n  if (product.producttype === \"simple\" || product.combo === true) {\n    sale_price = product.dsaleprice;\n    regular_price = product.dregularprice;\n  }\n\n  var value = 0;\n  var qtyVal = qty ? parseInt(qty) > 0 ? parseInt(qty) : 1 : 1;\n  var currency = \"$\";\n\n  if (sale_price) {\n    value = sale_price;\n  } else if (regular_price) {\n    value = regular_price;\n  }\n\n  if (value) {\n    if (subscribeChecked) {\n      var discount = subscribeDiscount;\n      var cutPrice = value - getParentage(parseFloat(discount), value);\n\n      if (onlyNew) {\n        return __jsx(\"span\", null, \" \" + currency, (cutPrice * qtyVal).toFixed(2));\n      }\n\n      return __jsx(\"span\", null, \" \" + currency, __jsx(\"strike\", null, numberFormat(value * qtyVal)), \" \", (cutPrice * qtyVal).toFixed(2)); // `${currency}${basicFunction.nombarFormat(value * qtyVal)}`\n    }\n\n    return \" \".concat(currency).concat(basicFunction.numberFormat(value * qtyVal));\n  }\n\n  return \"\";\n};\nexport var getBasicPrice = function getBasicPrice(product) {\n  var verifiedAttr = product.verifiedAttr,\n      variation = product.variation,\n      combo = product.combo,\n      producttype = product.producttype;\n\n  if (combo || producttype !== \"variable\") {\n    return {\n      regular_price: product.dregularprice,\n      sale_price: product.dsaleprice\n    };\n  }\n\n  if (verifiedAttr) {\n    if (verifiedAttr.constructor === Array) {\n      if (verifiedAttr.length > 0) {\n        var findItem = variation.find(function (el) {\n          var keyList = Object.keys(verifiedAttr[0]);\n          var flag = keyList.every(function (elx) {\n            return el[elx];\n          });\n          return flag;\n        });\n\n        if (findItem) {\n          var regular_price = findItem.regular_price,\n              sale_price = findItem.sale_price;\n          return {\n            regular_price: regular_price,\n            sale_price: sale_price\n          };\n        }\n      }\n    }\n  }\n\n  return {\n    regular_price: 0,\n    sale_price: 0\n  };\n};\nexport var directAddToCart = function directAddToCart(product) {\n  var qty = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n  var verifiedAttr = product.verifiedAttr;\n  var arr = verifiedAttr && verifiedAttr.constructor === Array ? verifiedAttr.map(function (el) {\n    var keys = Object.keys(el);\n    return keys.map(function (elx) {\n      return _defineProperty({}, elx, {\n        label: el[elx],\n        value: el[elx]\n      });\n    });\n  }) : [];\n  var obj = arr.map(function (el) {\n    return el.reduce(function (a, b) {\n      return _objectSpread(_objectSpread({}, a), b);\n    }, {});\n  });\n  var newVariation = obj && obj.length ? _objectSpread({}, obj[0]) : {};\n  return variablePriceSet(_objectSpread(_objectSpread(_objectSpread({}, product), newVariation), {}, {\n    qty: qty\n  }));\n};","map":null,"metadata":{},"sourceType":"module"}