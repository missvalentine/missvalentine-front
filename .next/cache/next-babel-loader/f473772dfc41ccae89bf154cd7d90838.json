{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState } from 'react';\nimport { connect } from 'react-redux';\nimport Link from 'next/link';\nimport classNames from 'classnames';\nimport './styles/app.scss';\nimport { toggleCartBar, hideCartBar, toggleRegBar } from '../redux/actions/drawers';\nimport { unsetUser } from '../redux/actions/user';\nimport { Menu, Dropdown } from 'antd';\nimport Input from './form-components/Input';\nimport CartIcon from './CartIcon';\nimport { SearchOutlined } from '@ant-design/icons';\nimport apiList from '../services/apis/apiList';\nimport { getVisibleProducts, addSlugToProduct, getProductTitle, getProductShortDesc, getBasicPrice } from '../services/helpers/product';\nimport projectSettings from '../constants/projectSettings';\nimport CartItem from './CartItem';\nimport { numberFormat } from '../services/helpers/misc';\nvar SubMenu = Menu.SubMenu;\n\nvar MobileMenu = function MobileMenu(_ref) {\n  var items = _ref.items,\n      user = _ref.user,\n      toggleCartBar = _ref.toggleCartBar,\n      toggleRegBar = _ref.toggleRegBar;\n\n  var _useState = useState(false),\n      isOpen = _useState[0],\n      setOpen = _useState[1];\n\n  var _useState2 = useState(''),\n      search = _useState2[0],\n      setSearch = _useState2[1];\n\n  var _useState3 = useState(false),\n      display = _useState3[0],\n      setDisplay = _useState3[1];\n\n  var _useState4 = useState([]),\n      products = _useState4[0],\n      setProducts = _useState4[1];\n\n  var onSubmit = function onSubmit(e) {\n    //console.log(`${window.location.origin}/search/${search}`);\n    // window.location.href(`${window.location.origin}/search/${search}`)\n    if (e.key === 'Enter') {\n      Router.push(\"/search/\".concat(search));\n    }\n  };\n\n  var menu = __jsx(\"div\", {\n    className: \"search-container\"\n  }, __jsx(Menu, null, __jsx(\"div\", {\n    style: {\n      marginTop: '40px'\n    }\n  }), products.length > 0 ? products.map(function (product, i) {\n    return __jsx(Menu.Item, {\n      style: {\n        height: 'fit-content'\n      },\n      key: i\n    }, __jsx(\"div\", {\n      className: \"c-cart-drawer\"\n    }, __jsx(CartItem, {\n      key: i,\n      title: product.title,\n      image: product.image,\n      subTitle: product.totalcbdmg,\n      price: \"$\".concat(numberFormat(parseFloat(product.price.sale_price))),\n      isSearch: true,\n      clearSearch: function clearSearch() {\n        setDisplay(false);\n        setSearch('');\n        setProducts([]);\n        Router.push(\"/shop/\".concat(product.title.replace(/ /g, '-')));\n      }\n    })));\n  }) : __jsx(SubMenu, null, __jsx(\"h2\", null, \"No records found\"))));\n\n  var filterProducts = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(value) {\n      var res, productList, visibleProducts, newList, productsRow, applySearch;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              setSearch(value);\n\n              if (!(value === '')) {\n                _context.next = 5;\n                break;\n              }\n\n              setDisplay(false);\n              setProducts([]);\n              return _context.abrupt(\"return\");\n\n            case 5:\n              setDisplay(true);\n              _context.next = 8;\n              return fetch(apiList.getAllProducts);\n\n            case 8:\n              res = _context.sent;\n              _context.next = 11;\n              return res.json();\n\n            case 11:\n              productList = _context.sent;\n              visibleProducts = getVisibleProducts(productList.products);\n              newList = visibleProducts.map(function (el) {\n                return addSlugToProduct(el);\n              });\n              productsRow = newList.map(function (el) {\n                return _objectSpread(_objectSpread({}, el), {}, {\n                  image: el.productImage ? projectSettings.serverUrl + el.productImage : '//via.placeholder.com/300x500',\n                  title: getProductTitle(el),\n                  subTitle: getProductShortDesc(el),\n                  price: getBasicPrice(el),\n                  qty: 1\n                });\n              });\n              applySearch = productsRow.filter(function (el) {\n                if (value === '') return false;\n                return el.title.toLowerCase().includes(value.toLowerCase());\n              }); // console.log(applySearch);\n\n              setProducts(applySearch);\n\n            case 17:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function filterProducts(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var _onClick = function onClick(e, action) {\n    if (action === \"link\") {}\n\n    if (action === \"cart\") {\n      toggleCartBar(); // setIsCartOpen(!isCartOpen)\n    }\n\n    if (action === \"reg\") {\n      toggleRegBar();\n    }\n\n    if (action === \"logout\") {\n      unsetUser();\n    }\n  };\n\n  return __jsx(\"ul\", {\n    className: \"c-nav__list\"\n  }, items.filter(function (el) {\n    console.log(el);\n\n    if (user._id) {\n      return el.onlyLogin !== false;\n    } else {\n      return el.onlyLogin !== true;\n    }\n  }).map(function (el, ind) {\n    return __jsx(\"li\", {\n      key: ind,\n      className: classNames(\"c-nav__list-item\", {\n        \"c-nav__list-item--has-sub-menu\": el.subMenus\n      })\n    }, el.action === 'input' ? __jsx(\"div\", {\n      style: {\n        position: 'relative'\n      }\n    }, __jsx(Input, {\n      prefix: __jsx(SearchOutlined, {\n        style: {\n          color: '#aaaaaa'\n        }\n      }),\n      value: search,\n      onChange: function onChange(e) {\n        return filterProducts(e.target.value);\n      },\n      onKeyDown: onSubmit,\n      label: \"Search\"\n    }), __jsx(Dropdown, {\n      overlayStyle: {\n        position: 'absolute',\n        top: '0 !important',\n        left: '0 !important',\n        width: '400px',\n        height: '500px',\n        overflow: 'scroll'\n      },\n      visible: display // visible={true}\n      ,\n      onVisibleChange: function onVisibleChange() {\n        return setDisplay(!display);\n      },\n      overlay: menu\n    }, __jsx(\"a\", {\n      className: \"ant-dropdown-link\",\n      onClick: function onClick(e) {\n        return e.preventDefault();\n      }\n    }))) : \"\", el.link ? __jsx(Link, {\n      as: el.as || el.link,\n      href: el.link\n    }, __jsx(\"a\", {\n      onClick: function onClick(e) {\n        _onClick(e, el.action);\n      },\n      className: \"c-nav__link\"\n    }, el.label, el.icon)) : __jsx(\"span\", {\n      onClick: function onClick(e) {\n        _onClick(e, el.action);\n      },\n      className: \"c-nav__link\"\n    }, el.label, el.icon), el.subMenus && __jsx(\"ul\", {\n      className: \"c-nav__sub-menu\"\n    }, el.subMenus.map(function (elx, i) {\n      return __jsx(\"li\", {\n        key: i,\n        className: \"c-nav__sub-menu-item\"\n      }, __jsx(Link, {\n        as: elx.as || elx.link,\n        href: elx.link\n      }, __jsx(\"a\", {\n        className: \"c-nav__link c-nav__link--sub\"\n      }, elx.label)));\n    })));\n  }));\n};\n\nMobileMenu.defaultProps = {\n  items: []\n};\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    isCartOpen: state.drawers.isCartOpen,\n    isRegOpen: state.drawers.isRegOpen,\n    hasLogin: state.drawers.hasLogin,\n    user: state.user\n  };\n};\n\nexport default connect(mapStateToProps, {\n  toggleCartBar: toggleCartBar,\n  hideCartBar: hideCartBar,\n  toggleRegBar: toggleRegBar,\n  unsetUser: unsetUser\n})(MobileMenu);","map":null,"metadata":{},"sourceType":"module"}