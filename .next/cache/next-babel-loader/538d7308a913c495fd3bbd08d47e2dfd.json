{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport dynamic from \"next/dynamic\";\nimport { useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport classNames from \"classnames\";\nvar Layout = dynamic(function () {\n  return import(\"../../components/Layouts/Layout\");\n}, {\n  ssr: false,\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak(\"../../components/Layouts/Layout\")];\n    },\n    modules: [\"../../components/Layouts/Layout\"]\n  }\n}); // const BundleProducts = dynamic(() => import(\"../../components/BundleProducts\"), {\n//   ssr: false,\n// });\n\nvar Heading = dynamic(function () {\n  return import(\"../../components/Heading\");\n}, {\n  ssr: false,\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak(\"../../components/Heading\")];\n    },\n    modules: [\"../../components/Heading\"]\n  }\n});\nimport apiList from \"../../services/apis/apiList\";\nvar ProductCard = dynamic(function () {\n  return import(\"../../components/ProductCard\");\n}, {\n  ssr: false,\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak(\"../../components/ProductCard\")];\n    },\n    modules: [\"../../components/ProductCard\"]\n  }\n});\nimport { getProductTitle, getProductShortDesc, getBasicPrice, addSlugToProduct, getVisibleProducts } from \"../../services/helpers/product\";\nimport { getBanner } from \"../../services/apis/blog\";\nimport projectSettings from \"../../constants/projectSettings\";\nimport fetch from \"isomorphic-unfetch\";\nimport { shopData } from \"../../redux/actions\";\nimport parse from \"html-react-parser\";\nimport { useEffect } from \"react\";\nimport { LazyLoadImage } from \"react-lazy-load-image-component\";\nimport { Spin } from \"antd\";\nimport { LoadingOutlined } from \"@ant-design/icons\";\n\nvar antIcon = __jsx(LoadingOutlined, {\n  style: {\n    fontSize: 50,\n    color: \"black\"\n  },\n  spin: true\n});\n\nvar Banner = dynamic(function () {\n  return import(\"../../components/Banner\");\n}, {\n  ssr: false,\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak(\"../../components/Banner\")];\n    },\n    modules: [\"../../components/Banner\"]\n  }\n});\n\nvar Shop = function Shop(_ref) {\n  var productList = _ref.productList,\n      combos = _ref.combos,\n      shopdata = _ref.shopdata,\n      props = _objectWithoutProperties(_ref, [\"productList\", \"combos\", \"shopdata\"]);\n\n  var _useState = useState(\"\"),\n      searchValue = _useState[0],\n      setSearchValue = _useState[1];\n\n  var _useState2 = useState(false),\n      isFilter = _useState2[0],\n      setIsFilter = _useState2[1];\n\n  var _useState3 = useState(\"\"),\n      selectedFilters = _useState3[0],\n      setSelectedFilters = _useState3[1];\n\n  var _useState4 = useState(\"\"),\n      imageUrl = _useState4[0],\n      setImageUrl = _useState4[1];\n\n  var productsRow = productList.map(function (el) {\n    console.log({\n      price: getBasicPrice(el),\n      el: el\n    });\n    return _objectSpread(_objectSpread({}, el), {}, {\n      image: el.productImage ? projectSettings.serverUrl + el.productImage : \"//via.placeholder.com/300x500\",\n      title: getProductTitle(el),\n      subTitle: getProductShortDesc(el),\n      price: getBasicPrice(el)\n    });\n  });\n  useEffect(function () {\n    fetchImage();\n  });\n\n  var fetchImage = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var _yield$getBanner, data;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return getBanner(\"shop\");\n\n            case 2:\n              _yield$getBanner = _context.sent;\n              data = _yield$getBanner.data;\n              setImageUrl(data.data.image.src);\n\n            case 5:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function fetchImage() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var applySearch = function applySearch(products) {\n    return products.filter(function (el) {\n      if (searchValue === \"\") return true;\n      return el.title.toLowerCase().includes(searchValue.toLowerCase());\n    });\n  };\n\n  var _useState5 = useState(_toConsumableArray(productsRow)),\n      products = _useState5[0],\n      setProducts = _useState5[1];\n\n  var onSearchChange = function onSearchChange(e) {\n    var value = e.target.value;\n    setSearchValue(value);\n  };\n\n  var filterProducts = function filterProducts(key) {\n    setSelectedFilters(key);\n\n    switch (key) {\n      case \"featured\":\n        var featuredProducts = products.filter(function (product) {\n          return product.featured;\n        });\n        var restProducts = products.filter(function (product) {\n          return !product.featured;\n        });\n        setProducts([].concat(_toConsumableArray(featuredProducts), _toConsumableArray(restProducts)));\n        break;\n\n      case \"l2h\":\n        setProducts(products.sort(function (a, b) {\n          return parseFloat(a.price.sale_price) - parseFloat(b.price.sale_price);\n        }));\n        break;\n\n      case \"h2l\":\n        setProducts(products.sort(function (a, b) {\n          return parseFloat(b.price.sale_price) - parseFloat(a.price.sale_price);\n        }));\n        break;\n\n      default:\n        // setProducts(products)\n        break;\n    }\n  };\n\n  var toTop = function toTop() {\n    window.scrollTo({\n      top: 0,\n      left: 0,\n      behavior: \"smooth\"\n    });\n  };\n\n  return __jsx(Layout, {\n    headerVersions: [\"bg-dark\"],\n    headerTheme: \"black\"\n  }, __jsx(Banner, {\n    image: imageUrl,\n    mobileImage: imageUrl,\n    versions: [\"black-heading\", \"shop\"]\n  }), __jsx(\"div\", {\n    className: \"c-shop-page\"\n  }, __jsx(\"div\", {\n    className: \"container-fluid\"\n  }, __jsx(\"div\", {\n    className: \"c-shop-page__row c-shop-page__row--light-bg row justify-content-center\"\n  }, __jsx(\"div\", {\n    className: \"col-xs-12\"\n  }, __jsx(Heading, {\n    versions: [\"shop-all\"]\n  }, parse(shopdata.title))))), __jsx(\"div\", {\n    className: \"c-shop-page__products-wrapper\"\n  }, __jsx(\"div\", {\n    className: \"c-shop-page__row row\"\n  }, applySearch(products).map(function (el) {\n    return __jsx(\"div\", {\n      key: el._id,\n      className: \"col-lg-4 col-md-6\"\n    }, __jsx(ProductCard, {\n      product: el,\n      versions: [\"show-price\", \"full-height\"],\n      title: el.title,\n      subTitle: el.subTitle,\n      image: el.image,\n      price: el.price && el.price.sale_price,\n      mg: el.totalcbdmg\n    }));\n  }))), combos && combos.length > 1 && __jsx(React.Fragment, null) // <div className=\"c-category-page__combos-wrapper\">\n  //   <div className=\"c-category-page__row\">\n  //     <div className=\"c-category-page__combos-wrapper-top\">\n  //       <div className=\"\">\n  //         <Heading\n  //           parentClass=\"c-category-page\"\n  //           versions={[\"large\", \"rgt-br\"]}\n  //         >\n  //           {/* TRY THE BUNDLES */}\n  //           {/* {parse(bundleTitle)} */}\n  //           {parse(\n  //             '<span style=\"font-size: 60px; line-height:50px;\"><b>Bundles of <br> Awesomeness!</b></span>'\n  //           )}\n  //         </Heading>\n  //       </div>\n  //       <div className=\"\">\n  //         <Heading\n  //           parentClass=\"c-category-page\"\n  //           subHeading={true}\n  //           versions={[\"light\"]}\n  //         >\n  //           {/* Give our bundles a try with our 60-day, money-back guarantee. The perfect gift. A great way to enjoy premium CBD at an incredible price. All bundles are 20% off. */}\n  //           {/* {parse(bundleContent)} */}\n  //           {parse(\n  //             '<div><span>Give our bundles a try with our 60-day money-back guarantee. A great way to enjoy premium CBD at an incredible price.<p style=\" margin-top: 20px;\"><b style=\"font-size:30px;\">All bundles are 20% off.</b></p></span></div>'\n  //           )}\n  //         </Heading>\n  //       </div>\n  //     </div>\n  //     <div\n  //       // className=\"c-category-products__bundles\"\n  //       style={{ marginTop: \"50px\" }}\n  //     >\n  //       {/* <BundleProducts versions={[\"no-padding\", \"h-auto\"]} bg=\"bggrey\" products={combos} />  */}\n  //       <BundleProducts\n  //         versions={[\"no-padding\", \"h-auto\", \"bundles\"]}\n  //         products={combos}\n  //       />\n  //       <div className=\"c-lr-section__btn-wrapper\">\n  //         {/* <Button theme=\"btm-br\" type=\"link\" link=\"/category/bundles\">\n  //           Explore More\n  //         </Button> */}\n  //       </div>\n  //     </div>\n  //   </div>\n  // </div>\n  , __jsx(\"div\", {\n    className: \"consult-doc-banner-wrapper\",\n    style: {\n      padding: '4rem 0'\n    }\n  }, __jsx(\"button\", {\n    className: \"top-btn\",\n    style: {\n      fontSize: \"x-large\"\n    },\n    onClick: function onClick() {\n      return toTop();\n    }\n  }, \"BACK TO TOP\", \" \", __jsx(LazyLoadImage, {\n    className: \"top\",\n    style: {\n      height: \"20px\",\n      marginBottom: \"5px\"\n    },\n    src: \"/images/arrow-up.png\",\n    alt: \"to-top\"\n  })))));\n};\n\nvar FilterItem = function FilterItem(_ref3) {\n  var isActive = _ref3.isActive,\n      onClick = _ref3.onClick,\n      children = _ref3.children;\n  return __jsx(\"div\", {\n    className: classNames(\"c-shop-page__filter-item\", {\n      \"c-shop-page__filter-item--active\": isActive\n    }),\n    onClick: onClick\n  }, children);\n};\n\nShop.getInitialProps = /*#__PURE__*/function () {\n  var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(_ref4) {\n    var query, res, productList, visibleProducts, Shopdata, comboRes, comboList, visibleCombo;\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            query = _ref4.query;\n            _context2.next = 3;\n            return fetch(apiList.getAllProducts);\n\n          case 3:\n            res = _context2.sent;\n            _context2.next = 6;\n            return res.json();\n\n          case 6:\n            productList = _context2.sent;\n            visibleProducts = getVisibleProducts(productList.products);\n            _context2.next = 10;\n            return shopData();\n\n          case 10:\n            Shopdata = _context2.sent;\n            _context2.next = 13;\n            return fetch(apiList.getAllCombos);\n\n          case 13:\n            comboRes = _context2.sent;\n            _context2.next = 16;\n            return comboRes.json();\n\n          case 16:\n            comboList = _context2.sent;\n            visibleCombo = getVisibleProducts(comboList.combos);\n            return _context2.abrupt(\"return\", {\n              category: query.cid,\n              productList: visibleProducts.map(function (el) {\n                return addSlugToProduct(el);\n              }),\n              combos: visibleCombo.map(function (el) {\n                return addSlugToProduct(el);\n              }),\n              shopdata: Shopdata.shop\n            });\n\n          case 19:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n\n  return function (_x) {\n    return _ref5.apply(this, arguments);\n  };\n}();\n\nexport default connect(null)(Shop);","map":null,"metadata":{},"sourceType":"module"}