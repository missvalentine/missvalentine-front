{"ast":null,"code":"import React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport dynamic from \"next/dynamic\";\nimport { useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport classNames from \"classnames\";\nconst Layout = dynamic(() => import(\"../../components/Layouts/Layout\"), {\n  ssr: false,\n  loadableGenerated: {\n    webpack: () => [require.resolveWeak(\"../../components/Layouts/Layout\")],\n    modules: [\"../../components/Layouts/Layout\"]\n  }\n}); // const BundleProducts = dynamic(() => import(\"../../components/BundleProducts\"), {\n//   ssr: false,\n// });\n\nconst Heading = dynamic(() => import(\"../../components/Heading\"), {\n  ssr: false,\n  loadableGenerated: {\n    webpack: () => [require.resolveWeak(\"../../components/Heading\")],\n    modules: [\"../../components/Heading\"]\n  }\n});\nimport apiList from \"../../services/apis/apiList\";\nconst ProductCard = dynamic(() => import(\"../../components/ProductCard\"), {\n  ssr: false,\n  loadableGenerated: {\n    webpack: () => [require.resolveWeak(\"../../components/ProductCard\")],\n    modules: [\"../../components/ProductCard\"]\n  }\n});\nimport { getProductTitle, getProductShortDesc, getBasicPrice, addSlugToProduct, getVisibleProducts } from \"../../services/helpers/product\";\nimport { getBanner } from \"../../services/apis/blog\";\nimport projectSettings from \"../../constants/projectSettings\";\nimport fetch from \"isomorphic-unfetch\";\nimport { shopData } from \"../../redux/actions\";\nimport parse from \"html-react-parser\";\nimport { useEffect } from \"react\";\nimport { LazyLoadImage } from \"react-lazy-load-image-component\";\nimport { Spin } from \"antd\";\nimport { LoadingOutlined } from \"@ant-design/icons\";\n\nconst antIcon = __jsx(LoadingOutlined, {\n  style: {\n    fontSize: 50,\n    color: \"black\"\n  },\n  spin: true\n});\n\nconst Banner = dynamic(() => import(\"../../components/Banner\"), {\n  ssr: false,\n  loadableGenerated: {\n    webpack: () => [require.resolveWeak(\"../../components/Banner\")],\n    modules: [\"../../components/Banner\"]\n  }\n});\n\nconst Shop = (_ref) => {\n  let {\n    productList,\n    combos,\n    shopdata\n  } = _ref,\n      props = _objectWithoutProperties(_ref, [\"productList\", \"combos\", \"shopdata\"]);\n\n  const {\n    0: searchValue,\n    1: setSearchValue\n  } = useState(\"\");\n  const {\n    0: isFilter,\n    1: setIsFilter\n  } = useState(false);\n  const {\n    0: selectedFilters,\n    1: setSelectedFilters\n  } = useState(\"\");\n  const {\n    0: imageUrl,\n    1: setImageUrl\n  } = useState(\"\");\n  const productsRow = productList.map(el => {\n    console.log({\n      price: getBasicPrice(el),\n      el\n    });\n    return _objectSpread(_objectSpread({}, el), {}, {\n      image: el.productImage ? projectSettings.serverUrl + el.productImage : \"//via.placeholder.com/300x500\",\n      title: getProductTitle(el),\n      subTitle: getProductShortDesc(el),\n      price: getBasicPrice(el)\n    });\n  });\n  useEffect(() => {\n    fetchImage();\n  });\n\n  const fetchImage = async () => {\n    const {\n      data\n    } = await getBanner(\"shop\");\n    setImageUrl(data.data.image.src);\n  };\n\n  const applySearch = products => products.filter(el => {\n    if (searchValue === \"\") return true;\n    return el.title.toLowerCase().includes(searchValue.toLowerCase());\n  });\n\n  const {\n    0: products,\n    1: setProducts\n  } = useState([...productsRow]);\n\n  const onSearchChange = e => {\n    const {\n      value\n    } = e.target;\n    setSearchValue(value);\n  };\n\n  const filterProducts = key => {\n    setSelectedFilters(key);\n\n    switch (key) {\n      case \"featured\":\n        const featuredProducts = products.filter(product => product.featured);\n        const restProducts = products.filter(product => !product.featured);\n        setProducts([...featuredProducts, ...restProducts]);\n        break;\n\n      case \"l2h\":\n        setProducts(products.sort((a, b) => parseFloat(a.price.sale_price) - parseFloat(b.price.sale_price)));\n        break;\n\n      case \"h2l\":\n        setProducts(products.sort((a, b) => parseFloat(b.price.sale_price) - parseFloat(a.price.sale_price)));\n        break;\n\n      default:\n        // setProducts(products)\n        break;\n    }\n  };\n\n  const toTop = () => {\n    window.scrollTo({\n      top: 0,\n      left: 0,\n      behavior: \"smooth\"\n    });\n  };\n\n  return __jsx(Layout, {\n    headerVersions: [\"bg-dark\"],\n    headerTheme: \"black\"\n  }, __jsx(Banner, {\n    image: imageUrl,\n    mobileImage: imageUrl,\n    versions: [\"black-heading\", \"shop\"]\n  }), __jsx(\"div\", {\n    className: \"c-shop-page\"\n  }, __jsx(\"div\", {\n    className: \"container-fluid\"\n  }, __jsx(\"div\", {\n    className: \"c-shop-page__row c-shop-page__row--light-bg row justify-content-center\"\n  }, __jsx(\"div\", {\n    className: \"col-xs-12\"\n  }, __jsx(Heading, {\n    versions: [\"shop-all\"]\n  }, parse(shopdata.title))))), __jsx(\"div\", {\n    className: \"c-shop-page__products-wrapper\"\n  }, __jsx(\"div\", {\n    className: \"c-shop-page__row row\"\n  }, applySearch(products).map(el => __jsx(\"div\", {\n    key: el._id,\n    className: \"col-lg-4 col-md-6\"\n  }, __jsx(ProductCard, {\n    product: el,\n    versions: [\"show-price\", \"full-height\"],\n    title: el.title,\n    subTitle: el.subTitle,\n    image: el.image,\n    price: el.price && el.price.sale_price,\n    mg: el.totalcbdmg\n  }))))), combos && combos.length > 1 && __jsx(React.Fragment, null) // <div className=\"c-category-page__combos-wrapper\">\n  //   <div className=\"c-category-page__row\">\n  //     <div className=\"c-category-page__combos-wrapper-top\">\n  //       <div className=\"\">\n  //         <Heading\n  //           parentClass=\"c-category-page\"\n  //           versions={[\"large\", \"rgt-br\"]}\n  //         >\n  //           {/* TRY THE BUNDLES */}\n  //           {/* {parse(bundleTitle)} */}\n  //           {parse(\n  //             '<span style=\"font-size: 60px; line-height:50px;\"><b>Bundles of <br> Awesomeness!</b></span>'\n  //           )}\n  //         </Heading>\n  //       </div>\n  //       <div className=\"\">\n  //         <Heading\n  //           parentClass=\"c-category-page\"\n  //           subHeading={true}\n  //           versions={[\"light\"]}\n  //         >\n  //           {/* Give our bundles a try with our 60-day, money-back guarantee. The perfect gift. A great way to enjoy premium CBD at an incredible price. All bundles are 20% off. */}\n  //           {/* {parse(bundleContent)} */}\n  //           {parse(\n  //             '<div><span>Give our bundles a try with our 60-day money-back guarantee. A great way to enjoy premium CBD at an incredible price.<p style=\" margin-top: 20px;\"><b style=\"font-size:30px;\">All bundles are 20% off.</b></p></span></div>'\n  //           )}\n  //         </Heading>\n  //       </div>\n  //     </div>\n  //     <div\n  //       // className=\"c-category-products__bundles\"\n  //       style={{ marginTop: \"50px\" }}\n  //     >\n  //       {/* <BundleProducts versions={[\"no-padding\", \"h-auto\"]} bg=\"bggrey\" products={combos} />  */}\n  //       <BundleProducts\n  //         versions={[\"no-padding\", \"h-auto\", \"bundles\"]}\n  //         products={combos}\n  //       />\n  //       <div className=\"c-lr-section__btn-wrapper\">\n  //         {/* <Button theme=\"btm-br\" type=\"link\" link=\"/category/bundles\">\n  //           Explore More\n  //         </Button> */}\n  //       </div>\n  //     </div>\n  //   </div>\n  // </div>\n  , __jsx(\"div\", {\n    className: \"consult-doc-banner-wrapper\",\n    style: {\n      padding: '4rem 0'\n    }\n  }, __jsx(\"button\", {\n    className: \"top-btn\",\n    style: {\n      fontSize: \"x-large\"\n    },\n    onClick: () => toTop()\n  }, \"BACK TO TOP\", \" \", __jsx(LazyLoadImage, {\n    className: \"top\",\n    style: {\n      height: \"20px\",\n      marginBottom: \"5px\"\n    },\n    src: \"/images/arrow-up.png\",\n    alt: \"to-top\"\n  })))));\n};\n\nconst FilterItem = ({\n  isActive,\n  onClick,\n  children\n}) => __jsx(\"div\", {\n  className: classNames(\"c-shop-page__filter-item\", {\n    \"c-shop-page__filter-item--active\": isActive\n  }),\n  onClick: onClick\n}, children);\n\nShop.getInitialProps = async ({\n  query\n}) => {\n  const res = await fetch(apiList.getAllProducts);\n  const productList = await res.json();\n  const visibleProducts = getVisibleProducts(productList.products);\n  const Shopdata = await shopData();\n  const comboRes = await fetch(apiList.getAllCombos);\n  const comboList = await comboRes.json();\n  const visibleCombo = getVisibleProducts(comboList.combos);\n  return {\n    category: query.cid,\n    productList: visibleProducts.map(el => addSlugToProduct(el)),\n    combos: visibleCombo.map(el => addSlugToProduct(el)),\n    shopdata: Shopdata.shop\n  };\n};\n\nexport default connect(null)(Shop);","map":null,"metadata":{},"sourceType":"module"}